# Create the bar chart, grouping by 'Season' and dodging by 'Category'
# geom_col is used for data where the y-values are already calculated (counts/prevalence)
geom_col(
position = position_dodge(width = 0.8), # Ensures bars are side-by-side
width = 0.7, # Bar width
color = "black", # Add black border to match the image style
linewidth = 0.2
) +
# Add the data labels on top of the bars
geom_text(
aes(label = sprintf("%.2f", Value)), # Format the label to 2 decimal places (or use %.0f for counts)
position = position_dodge(width = 0.8), # Must match the geom_col dodge position
vjust = -0.5, # Nudge the text above the bars
size = 4, # Text size
color = "black"
) +
# Customize the colors to match the image (light blue and salmon/coral)
scale_fill_manual(
values = c("Positive" = "#66c2d1", "Prevalence" = "#f4a298")
) +
# Customize the X and Y axis labels (MANDATORY AXES INCLUSION)
labs(
x = "Season", # X-axis label (Mandatory)
y = "Value", # Y-axis label (Mandatory)
fill = NULL, # Remove the legend title
title = "Season-wise Positive Cases and Prevalence" # Optional: Add a main title
) +
# Apply a clean theme (like theme_minimal or theme_classic) and further customization
theme_minimal() +
theme(
# Set the background to white
panel.background = element_rect(fill = "white", color = NA),
plot.background = element_rect(fill = "white", color = NA),
# Customize the panel grid lines (dashed lines in the image)
panel.grid.major.x = element_blank(), # Remove vertical grid lines
panel.grid.major.y = element_line(linetype = "dashed", color = "gray80"), # Dashed horizontal grid lines
# Customize axis text and titles
axis.title.x = element_text(size = 14, face = "bold", margin = margin(t = 15)),
axis.title.y = element_text(size = 14, face = "bold", margin = margin(r = 15)),
axis.text.x = element_text(size = 12),
axis.text.y = element_text(size = 12),
# Customize the legend position (top center, horizontal)
legend.position = "top",
legend.direction = "horizontal",
legend.box.just = "center",
legend.key.size = unit(0.5, "cm"),
legend.text = element_text(size = 12),
# Set the Y-axis limits and breaks
ylim(0, 160)
)
# Load the required libraries
# The 'tidyverse' package includes 'ggplot2', 'dplyr', and 'tidyr'
library(tidyverse)
# Load the required libraries
# The 'tidyverse' package includes 'ggplot2', 'dplyr', and 'tidyr'
library(tidyverse)
prevalence_samples_data <- tibble(
# Define the Season and ensure the order is correct
Season = factor(
c("Summer", "Summer", "Rainy", "Rainy"),
levels = c("Summer", "Rainy")
),
Category = factor(
c("Prevalence", "Samples Tested", "Prevalence", "Samples Tested"),
levels = c("Prevalence", "Samples Tested") # Ensure 'Prevalence' is the 1st bar in each group
),
prevalence_samples_data <- tibble(
# Define the Season and ensure the order is correct
Season = factor(
c("Summer", "Summer", "Rainy", "Rainy"),
levels = c("Summer", "Rainy")
),
# Define the category for each bar
Category = factor(
c("Prevalence", "Samples Tested", "Prevalence", "Samples Tested"),
levels = c("Prevalence", "Samples Tested") # Ensure 'Prevalence' is the 1st bar in each group
),
# Assign realistic sample values and reuse prevalence values from the image
Value = c(43.48, 300, 53.26, 600)
)
prevalence_samples_plot <- ggplot(
prevalence_samples_plot <- ggplot(
prevalence_samples_data,
aes(x = Season, y = Value, fill = Category)
)
prevalence_samples_data <- tibble(
# Define the Season and ensure the order is correct
Season = factor(
c("Summer", "Summer", "Rainy", "Rainy"),
levels = c("Summer", "Rainy")
),
# Define the category for each bar
Category = factor(
c("Prevalence", "Samples Tested", "Prevalence", "Samples Tested"),
levels = c("Prevalence", "Samples Tested") # Ensure 'Prevalence' is the 1st bar in each group
),
# Assign realistic sample values and reuse prevalence values from the image
Value = c(43.48, 300, 53.26, 600)
)
prevalence_samples_plot <- ggplot(
prevalence_samples_data,
aes(x = Season, y = Value, fill = Category)
) +
# Create the bar chart using geom_col (for pre-calculated heights)
geom_col(
position = position_dodge(width = 0.8), # Ensures bars are side-by-side
width = 0.7,
color = "black",
linewidth = 0.2
) +
# Add the data labels on top of the bars
geom_text(
# Use different formatting for Prevalence (%.2f) vs. Samples Tested (%.0f)
aes(label = ifelse(
Category == "Prevalence",
sprintf("%.2f%%", Value),
sprintf("%.0f", Value)
)),
position = position_dodge(width = 0.8),
vjust = -0.5, # Nudge the text above the bars
size = 4,
color = "black"
) +
# Customize the colors for the two new categories
scale_fill_manual(
values = c("Prevalence" = "#f4a298", "Samples Tested" = "#66c2d1")
) +
# *** CRUCIAL: Set the X and Y axis labels as required ***
labs(
x = "Season of Testing", # X-axis label (Mandatory)
y = "Scale of Measurement (Count / Percentage)", # Y-axis label (Mandatory)
fill = "Data Type",
title = "Comparison of Prevalence and Samples Tested by Season"
) +
# Apply a clean theme for readability
theme_minimal() +
theme(
# Ensure Axis Titles are large and bold for prominence
axis.title.x = element_text(size = 14, face = "bold", margin = margin(t = 15)),
axis.title.y = element_text(size = 14, face = "bold", margin = margin(r = 15)),
panel.grid.major.x = element_blank(),
panel.grid.major.y = element_line(linetype = "dashed", color = "gray80"),
legend.position = "top"
)
# Print the final plot
print(prevalence_samples_plot)
library(ggplot2)
season   <- c("Summer","Rainy","Summer","Rainy")
category <- c("Prevalence","Prevalence","Samples Tested","Samples Tested")
value    <- c(43.48,53.26,138,276)
df <- data.frame(season, category, value)
View(df)
ggplot(df, aes(x = category, y = value, fill = season)) +
geom_bar(stat = "identity", position = "dodge") +
labs(
x = "Category",
y = "Value",
title = "Broiler Serum Test Result by Season"
) +
theme_minimal() +
theme(
text = element_text(size = 14),
plot.title = element_text(hjust = 0.5, face = "bold")
)
library(ggplot2)
# Data
Category <- c("Summer Prevalence",
"Summer Samples",
"Rainy Prevalence",
"Rainy Samples")
Value <- c(43.48, 138, 53.26, 276)
df <- data.frame(Category, Value)
# Plot
ggplot(df, aes(x = Category, y = Value)) +
geom_bar(stat = "identity") +
geom_text(aes(label = Value),
vjust = -0.5, size = 5) +
labs(
x = "Category",
y = "Value",
title = "Broiler Serum Sample Testing Result"
) +
theme_minimal() +
theme(
axis.text.x = element_text(angle = 25, hjust = 1, size = 13),
axis.title = element_text(size = 14),
plot.title = element_text(size = 16, face = "bold")
)
library(ggplot2)
# Data
Category <- c("Summer Prevalence",
"Summer Samples",
"Rainy Prevalence",
"Rainy Samples")
Value <- c(43.48, 138, 53.26, 276)
df <- data.frame(Category, Value)
# Plot
ggplot(df, aes(x = Category, y = Value)) +
geom_col() +
geom_text(aes(label = Value), vjust = -0.5, size = 5) +
labs(
x = "Category",
y = "Value"
) +
theme_minimal() +
theme(
axis.text.x = element_text(angle = 20, hjust = 1, size = 12),
axis.title = element_text(size = 14)
)
library(ggplot2)
# Data
Category <- c("Summer Prevalence",
"Summer Samples",
"Rainy Prevalence",
"Rainy Samples")
Value <- c(43.48, 138, 53.26, 276)
df <- data.frame(Category, Value)
# Plot
ggplot(df, aes(x = Category, y = Value)) +
geom_col() +
geom_text(aes(label = Value), vjust = -0.5, size = 5) +
labs(
x = "Category",
y = "Value"
) +
theme_minimal() +
theme(
axis.text.x = element_text(angle = 20, hjust = 1, size = 12),
axis.title = element_text(size = 14)
)
library(ggplot2)
# Data
Category <- c("Summer Prevalence", "Summer Samples", "Rainy Prevalence", "Rainy Samples")
Value <- c(43.48, 138, 53.26, 276)
df <- data.frame(Category, Value)
# Plot
ggplot(df, aes(x = Category, y = Value)) +
geom_bar(stat = "identity", fill = "skyblue", color = "black") +  # bar fill and border
geom_text(aes(label = Value), vjust = -0.5, size = 5) +          # number on top
labs(x = "Category", y = "Value", title = "Broiler Serum Sample Results") +
theme_bw() +                                                     # clear axes with ticks
theme(
axis.text.x = element
library(ggplot2)
library(ggplot2)
# Data
Category <- c("Summer Prevalence", "Summer Samples", "Rainy Prevalence", "Rainy Samples")
Value <- c(43.48, 138, 53.26, 276)
df <- data.frame(Category, Value)
# Plot
ggplot(df, aes(x = Category, y = Value)) +
geom_bar(stat = "identity", fill = "skyblue", color = "black") +  # bar fill and border
geom_text(aes(label = Value), vjust = -0.5, size = 5) +          # number on top
labs(x = "Category", y = "Value", title = "Broiler Serum Sample Results") +
theme_bw() +                                                     # clear axes with ticks
theme(
axis.text.x = element
library(ggplot2)
library(ggplot2)
# Data
Category <- c("Summer Prevalence", "Summer Samples", "Rainy Prevalence", "Rainy Samples")
Value <- c(43.48, 138, 53.26, 276)
df <- data.frame(Category, Value)
# Plot
ggplot(df, aes(x = Category, y = Value)) +
geom_bar(stat = "identity", fill = "skyblue", color = "black") +  # bar fill and border
geom_text(aes(label = Value), vjust = -0.5, size = 5) +          # number on top
labs(x = "Category", y = "Value", title = "Broiler Serum Sample Results") +
theme_bw() +                                                     # clear axes with ticks
theme(
axis.text.x = element
library(ggplot2)
library(ggplot2)
# Data
Category <- c("Summer Prevalence", "Summer Samples", "Rainy Prevalence", "Rainy Samples")
Value <- c(43.48, 138, 53.26, 276)
df <- data.frame(Category, Value)
# Plot
ggplot(df, aes(x = Category, y = Value)) +
geom_bar(stat = "identity", fill = "skyblue", color = "black") +  # bar fill and border
geom_text(aes(label = Value), vjust = -0.5, size = 5) +          # number on top
labs(x = "Category", y = "Value", title = "Broiler Serum Sample Results") +
theme_bw() +                                                     # clear axes with ticks
theme(
axis.text.x = element
data <- data.frame(
data <- data.frame(
Category = c("A", "B", "C", "D"),
Prevalence = c(43.48, 35.21, 50.00, 28.75),
Sample_Tested = c(138, 120, 160, 115)
)
# Basic bar graph with labels
ggplot(data, aes(x = Category, y = Prevalence)) +
geom_bar(stat = "identity", fill = "steelblue") +           # Create bars
geom_text(aes(label = paste0(Prevalence, "\n(n=", Sample_Tested, ")")),
vjust = -0.5, size = 4) +                        # Add numbers on top
labs(
title = "Prevalence of Disease by Category",
x = "Category",                                           # x-axis label
y = "Prevalence (%)"                                      # y-axis label
) +
theme_minimal() +                                           # Clean theme
theme(
axis.text = element_text(size = 12),                      # Axis text size
axis.title = element_text(size = 14, face = "bold")       # Axis title size
)
setwd("G:/Class Works/R-for-Data-Science-and-Machine-Learning-with-NBICT-Lab-B-8/RDSML-Day-56 ðŸ‘‰ Support Vector Regression in R (Part-4)")
library(e1071)
library(ggplot2)
library(dplyr)
dataset <- read.csv("day.csv")
bike <- dataset %>%
select(cnt, temp, atemp, hum, windspeed, season, yr, mnth,
holiday,weekday, workingday, weathersit)
str(bike)
# Convert categorical variables to factors
bike <- bike %>%
mutate(
season = factor(season),
yr = factor(yr),
mnth = factor(mnth),
holiday = factor(holiday),
weekday = factor(weekday),
workingday = factor(holiday),
weathersit = factor(weathersit)
)
str(bike)
# Train/Test split # set.seed(123) dile bar baar same value asbe
set.seed(123)
n <- nrow(bike)
indices <- seq_len(n)
# idx for index
train_idx <- sample(indices, size = 0.7*n)
train_set <- bike[train_idx, ]
# column er ghor faka rakhlam mane sob koita column thakbe
test_set <- bike[-train_idx, ]
# minus - diye train_idx theke bad diye ja thakbe seta diye test det hobe
# Scale numeric features
# Identify numeric predictors
num_cols <- c("temp", "atemp", "hum", "windspeed")
# Computing scaling parameters on training data
train_means <- sapply(train_set[, num_cols], mean)
train_sds <- sapply(train_set[, num_cols], sd)
# Scale Function
# 4 ta individual column er value theke mean bad diye
# sd diye vag korbo,tai ei function
# last e df dilam jeno full dataframe cover kore
scale_num <- function(df){
df[, num_cols] <- sweep(df[, num_cols], 2, train_means, "-")
df[, num_cols] <- sweep(df[, num_cols], 2, train_sds, "/")
df
}
# train_set ke df er moddhe dhukiye dite hobe
train_scaled <- scale_num(train_set)
test_scaled <- scale_num(test_set)
# Building a linear regression model
lm_model <- lm(cnt ~ ., data = train_scaled)
summary(lm_model)
# Now we will perform prediction
lm_pred <- predict(lm_model, newdata = test_scaled)
# Evaluation matrix for linear regression
# Calculating root mean square error
rmse <- function(actual, pred) sqrt(mean((actual-pred)^2))
lm_rmse <- rmse(test_scaled$cnt, lm_pred)
lm_rmse
# Calculating mean absolute error
mae <- function(actual,pred) mean(abs(actual-pred))
lm_mae <- mae(test_scaled$cnt, lm_pred)
lm_mae
# Building support vector regression model (svr)
svr <- svm (cnt ~ . , data = train_scaled, kernel = "linear")
svr_pred <- predict(svr, newdata = test_scaled)
svr_pred
svr_rmse <- rmse(test_scaled$cnt, svr_pred)
svr_mae <- mae(test_scaled$cnt, svr_pred)
# Setup packages andd data loading
#install.packages(c("e1071", "ggplot2", "dplyr"))
library(e1071)
library(ggplot2)
library(dplyr)
# Loading the dataset
dataset <- read.csv("day.csv")
# Basic cleaning and feature selection
bike <- dataset %>%
select(cnt, temp, atemp, hum, windspeed, season, yr, mnth,
holiday,weekday, workingday, weathersit)
str(bike)
# Convert categorical variables to factors
bike <- bike %>%
mutate(
season = factor(season),
yr = factor(yr),
mnth = factor(mnth),
holiday = factor(holiday),
weekday = factor(weekday),
workingday = factor(holiday),
weathersit = factor(weathersit)
)
str(bike)
# Train/Test split # set.seed(123) dile bar baar same value asbe
set.seed(123)
n <- nrow(bike)
indices <- seq_len(n)
# idx for index
train_idx <- sample(indices, size = 0.7*n)
train_set <- bike[train_idx, ]
# column er ghor faka rakhlam mane sob koita column thakbe
test_set <- bike[-train_idx, ]
# minus - diye train_idx theke bad diye ja thakbe seta diye test det hobe
# Scale numeric features
# Identify numeric predictors
num_cols <- c("temp", "atemp", "hum", "windspeed")
# Computing scaling parameters on training data
train_means <- sapply(train_set[, num_cols], mean)
train_sds <- sapply(train_set[, num_cols], sd)
# Scale Function
# 4 ta individual column er value theke mean bad diye
# sd diye vag korbo,tai ei function
# last e df dilam jeno full dataframe cover kore
scale_num <- function(df){
df[, num_cols] <- sweep(df[, num_cols], 2, train_means, "-")
df[, num_cols] <- sweep(df[, num_cols], 2, train_sds, "/")
df
}
# train_set ke df er moddhe dhukiye dite hobe
train_scaled <- scale_num(train_set)
test_scaled <- scale_num(test_set)
# Building a linear regression model
lm_model <- lm(cnt ~ ., data = train_scaled)
summary(lm_model)
# Now we will perform prediction
lm_pred <- predict(lm_model, newdata = test_scaled)
# Evaluation matrix for linear regression
# Calculating root mean square error
rmse <- function(actual, pred) sqrt(mean((actual-pred)^2))
lm_rmse <- rmse(test_scaled$cnt, lm_pred)
lm_rmse
# Calculating mean absolute error
mae <- function(actual,pred) mean(abs(actual-pred))
lm_mae <- mae(test_scaled$cnt, lm_pred)
lm_mae
# Building support vector regression model (svr)
svr <- svm (cnt ~ . , data = train_scaled, kernel = "linear")
svr_pred <- predict(svr, newdata = test_scaled)
svr_pred
svr_rmse <- rmse(test_scaled$cnt, svr_pred)
svr_mae <- mae(test_scaled$cnt, svr_pred)
svr_rmse;svr_mae
lm_rmse
lm_mae
setwd("G:/Class Works/R-for-Data-Science-and-Machine-Learning-with-NBICT-Lab-B-8/RDSML-Day-56 ðŸ‘‰ Support Vector Regression in R (Part-4)")
library(e1071)
library(ggplot2)
library(dplyr)
dataset <- read.csv("day.csv")
bike <- dataset %>%
select(cnt, temp, atemp, hum, windspeed, season, yr, mnth,
holiday,weekday, workingday, weathersit)
str(bike)
bike <- bike %>%
mutate(
season = factor(season),
yr = factor(yr),
mnth = factor(mnth),
holiday = factor(holiday),
weekday = factor(weekday),
workingday = factor(holiday),
weathersit = factor(weathersit)
)
str(bike)
# Train/Test split # set.seed(123) dile bar baar same value asbe
set.seed(123)
n <- nrow(bike)
indices <- seq_len(n)
train_idx <- sample(indices, size = 0.7*n)
train_set <- bike[train_idx, ]
test_set <- bike[-train_idx, ]
num_cols <- c("temp", "atemp", "hum", "windspeed")
train_means <- sapply(train_set[, num_cols], mean)
train_sds <- sapply(train_set[, num_cols], sd)
scale_num <- function(df){
df[, num_cols] <- sweep(df[, num_cols], 2, train_means, "-")
df[, num_cols] <- sweep(df[, num_cols], 2, train_sds, "/")
df
}
train_scaled <- scale_num(train_set)
test_scaled <- scale_num(test_set)
lm_model <- lm(cnt ~ ., data = train_scaled)
summary(lm_model)
# Now we will perform prediction
lm_pred <- predict(lm_model, newdata = test_scaled)
# Evaluation matrix for linear regression
# Calculating root mean square error
rmse <- function(actual, pred) sqrt(mean((actual-pred)^2))
lm_rmse <- rmse(test_scaled$cnt, lm_pred)
lm_rmse
# Calculating mean absolute error
mae <- function(actual,pred) mean(abs(actual-pred))
lm_mae <- mae(test_scaled$cnt, lm_pred)
lm_mae
# Building support vector regression model (svr)
svr <- svm (cnt ~ . , data = train_scaled, kernel = "linear")
svr_pred <- predict(svr, newdata = test_scaled)
svr_pred
svr_rmse <- rmse(test_scaled$cnt, svr_pred)
svr_mae <- mae(test_scaled$cnt, svr_pred)
View(bike)
View(test_scaled)
View(test_set)
View(test_scaled)
View(train_scaled)
View(train_set)
